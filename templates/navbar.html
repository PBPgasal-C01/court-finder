{% load static %}
<nav class="w-full bg-[#698C6A] text-white">
  <div class="max-w-7xl mx-auto grid grid-cols-12 items-center px-6 py-3 gap-4">
    <!-- Left: Logo + Brand -->
    <a href="{% url 'main:show_main' %}" class="col-span-6 md:col-span-3 flex items-center gap-3">
      <img src="{% static 'images/cflogo.png' %}" alt="CourtFinder logo" class="h-10 w-auto" />
      <span class="hidden sm:inline text-xl font-semibold tracking-widest">
        <span class="text-[#3F5940]">COURT</span><span class="text-white">FINDER</span>
      </span>
    </a>

    <!-- Center: Desktop Menu -->
    <div class="col-span-12 md:col-span-6 hidden md:flex justify-center items-center gap-8 text-sm font-semibold">
      <a href="{% url 'main:show_main' %}" class="hover:text-gray-200 transition">Home</a>
      <a href="#" class="hover:text-gray-200 transition">Finder</a>
      <a href="{% url 'blog:list' %}" class="hover:text-gray-200 transition">Blog</a>
      <a href="#" class="hover:text-gray-200 transition">Game Scheduler</a>
      <a href="#" class="hover:text-gray-200 transition">Manage Court</a>
      <a href="#" class="hover:text-gray-200 transition">Complain</a>
    </div>

    <!-- Right: Auth -->
    <div class="col-span-6 md:col-span-3 flex justify-end items-center gap-3 relative">
      {% if user.is_authenticated %}
        <!-- Avatar + Dropdown -->
        <div class="relative">
          <button id="avatar-btn" class="focus:outline-none">
              {% if user.photo %}
              <img src="{{ user.photo.url }}" alt="avatar"
                  class="w-10 h-10 rounded-full object-cover border-2 border-white">
              {% else %}
              <img src="https://via.placeholder.com/40" alt="avatar"
                  class="w-10 h-10 rounded-full object-cover border-2 border-white">
              {% endif %}
          </button>

          <!-- Dropdown -->
          <div id="dropdown-menu"
              class="absolute right-0 mt-2 w-48 bg-white text-gray-800 rounded-lg shadow-xl ring-1 ring-black/5
                      opacity-0 scale-95 pointer-events-none transition-all duration-200 origin-top-right">
              <div class="py-1">
                <a href="{% url 'autentikasi:profile_view' %}"
                  class="block px-4 py-2 text-sm font-semibold text-[#2F593F] hover:bg-gray-100 transition">
                  Profile
                </a>
                {% if user.is_staff or user.is_superuser %}
                <a href="{% url 'autentikasi:admin_dashboard' %}"
                  class="block px-4 py-2 text-sm font-semibold text-[#698C6A] hover:bg-[#F2F6F6] hover:text-[#2F593F] transition">
                  Manage Users
                </a>
                {% endif %}
                <div class="my-1 h-px bg-gray-100"></div>
                <a href="{% url 'autentikasi:logout' %}"
                  class="block px-4 py-2 text-sm font-semibold text-red-600 hover:bg-red-50 hover:text-red-700 transition">
                  Logout
                </a>
              </div>
          </div>
        </div>
      {% else %}
        <a href="{% url 'autentikasi:register' %}"
           class="bg-[#4B6356] hover:bg-[#3e5548] text-white text-sm font-medium px-4 py-2 rounded-md transition">
          Sign in
        </a>
        <a href="{% url 'autentikasi:login' %}"
           class="bg-white hover:bg-gray-100 text-[#698C6A] text-sm font-medium px-4 py-2 rounded-md transition">
          Log in
        </a>
      {% endif %}

      <!-- Hamburger Button (Mobile) -->
      <button id="menu-btn" class="md:hidden ml-2 focus:outline-none" aria-label="Toggle menu">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden border-t border-[#4F6C4F] text-sm bg-[#698C6A]">
    <div class="flex flex-col items-center py-3 space-y-2">
      <a href="{% url 'main:show_main' %}" class="hover:text-gray-200 transition">Home</a>
      <a href="#" class="hover:text-gray-200 transition">Finder</a>
      <a href="{% url 'blog:list' %}" class="hover:text-gray-200 transition">Blog</a>
      <a href="#" class="hover:text-gray-200 transition">Game Scheduler</a>
      <a href="#" class="hover:text-gray-200 transition">Manage Court</a>
      <a href="#" class="hover:text-gray-200 transition">Complaint</a>

      {% if user.is_authenticated %}
        <div class="flex flex-col items-center gap-2 pt-2">
          <a href="{% url 'autentikasi:profile_view' %}"
             class="bg-white text-[#698C6A] text-sm font-medium px-4 py-2 rounded-md hover:bg-gray-100 transition">
            Profile
          </a>
          <a href="{% url 'autentikasi:logout' %}"
             class="bg-[#C1725D] hover:bg-[#a45c4b] text-white text-sm font-medium px-4 py-2 rounded-md transition">
            Logout
          </a>
        </div>
      {% else %}
        <div class="flex flex-col items-center gap-2 pt-2">
          <a href="{% url 'autentikasi:register' %}"
             class="bg-[#4B6356] hover:bg-[#3e5548] text-white text-sm font-medium px-4 py-2 rounded-md transition">
            Sign in
          </a>
          <a href="{% url 'autentikasi:login' %}"
             class="bg-white hover:bg-gray-100 text-[#698C6A] text-sm font-medium px-4 py-2 rounded-md transition">
            Log in
          </a>
        </div>
      {% endif %}
    </div>
  </div>
</nav>

<script>
  const menuBtn = document.getElementById("menu-btn");
  const mobileMenu = document.getElementById("mobile-menu");
  menuBtn.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });

  // Avatar dropdown animation
  const avatarBtn = document.getElementById("avatar-btn");
  const dropdown = document.getElementById("dropdown-menu");
  if (avatarBtn && dropdown) {
    const show = () => {
      dropdown.classList.remove("opacity-0", "scale-95", "pointer-events-none");
      dropdown.classList.add("opacity-100", "scale-100");
    };
    const hide = () => {
      dropdown.classList.add("opacity-0", "scale-95", "pointer-events-none");
      dropdown.classList.remove("opacity-100", "scale-100");
    };

    avatarBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      if (dropdown.classList.contains("pointer-events-none")) show(); else hide();
    });

    globalThis.addEventListener("click", (e) => {
      if (!dropdown.contains(e.target) && !avatarBtn.contains(e.target)) hide();
    });
  }
</script>


